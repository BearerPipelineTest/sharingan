package protocol

import (
	"encoding/hex"
	"fmt"
	"testing"
)

func TestBinaryThrift_Parse(t *testing.T) {

	t.Run("with_header", func(t *testing.T) {
		body, _ := hex.DecodeString("0000009780010001000000144d756c746941726561496e666f4279436f6f7264000000000c00010a00010000004fd38884980b00020000002031443336363732393841384539304136373632313335423242454344453543390f00030c00000001040001405b16897635e7430400024036c9c193b3a68b00080004000000020c000508000100000002000c00060a00010000000000000080000000")
		var p BinaryThrift
		pairs, _, _, _ := p.Parse(string(body))
		fmt.Println(pairs)
	})

	t.Run("without_header", func(t *testing.T) {
		body, _ := hex.DecodeString("80010001000000144d756c746941726561496e666f4279436f6f7264000000000c00010a00010000004fd38884980b00020000002031443336363732393841384539304136373632313335423242454344453543390f00030c00000001040001405b16897635e7430400024036c9c193b3a68b00080004000000020c000508000100000002000c00060a00010000000000000080000000")
		var p BinaryThrift
		pairs, _, _, _ := p.Parse(string(body))
		fmt.Println(pairs)
	})
}
